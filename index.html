<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Netlify Site - Payment API</title>
   <meta http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'nonce-abc123'; frame-src https://iamsameeraliyanage.github.io;">
</head>

<body>
   <h1>Netlify Site - Payment API</h1>

   <!-- Communication Log -->
   <div id="communication-log">
      <h3>Communication Log:</h3>
      <ul id="log"></ul>
   </div>

   <!-- GitHub iframe for Bank API -->
   <iframe id="github-iframe" src="https://iamsameeraliyanage.github.io/iframe-github-test" width="600" height="400"
      sandbox="allow-scripts allow-same-origin"></iframe>

   <script nonce="abc123">
      const githubIframe = document.getElementById('github-iframe');
      const log = document.getElementById('log');

      window.addEventListener('message', (event) => {
         if (event.origin === 'https://iframe-vercel-test.vercel.app') {
            logMessage(`Received from Vercel: ${JSON.stringify(event.data)}`);

            githubIframe.contentWindow.postMessage(event.data, 'https://iamsameeraliyanage.github.io');
         } else if (event.origin === 'https://iamsameeraliyanage.github.io') {
            logMessage(`Received from GitHub: ${JSON.stringify(event.data)}`);
            window.parent.postMessage(event.data, 'https://iframe-vercel-test.vercel.app');
         } else {
            console.warn("Untrusted message origin:", event.origin);
         }
      });

      function logMessage(message) {
         const item = document.createElement('li');
         item.textContent = message;
         log.appendChild(item);
      }
   </script>
</body>

</html>